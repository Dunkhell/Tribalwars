/*!
 * 
 *             Script: Faking
 *             Created by: Hermitowski
 *             Version: 4.0.0.0 (221308643069c0a396c9c7efcd8eb8d63fca8910)
 *             Licence: GNU GENERAL PUBLIC LICENSE VERSION 3 https://www.gnu.org/licenses/gpl-3.0.en.html
 *
 *             You can find sources used to built this script here: https://github.com/RNabla/tribalwars/scripts
 *
 */(()=>{"use strict";var n={982:n=>{n.exports=JSON.parse('{"ATTACK_TIME":"Wojsko dojdzie __DAY__.__MONTH__ na __HOURS__:__MINUTES__<br/>Cel: __TARGET__ __PLAYER_INFO__","ERROR_FORUM_CONFIG_THREAD_ID":"forum_config.thread_id jest nieprawidłowy","ERROR_FORUM_CONFIG_SPOILER_NAME":"forum_config.spoiler_name jest nieprawidłowy","ERROR_FORUM_CONFIG_TTL":"forum_config.ttl jest nieprawidłowy","ERROR_FORUM_CONFIG_PAGE":"forum_config.page jest nieprawidłowy","ERROR_FORUM_CONFIG_THREAD_DOES_NOT_EXIST":"Wątek nie istnieje","ERROR_FORUM_CONFIG_SPOILER_NONE":"Spoiler o podanej nazwie nie istnieje","ERROR_FORUM_CONFIG_SPOILER_MULTIPLE":"Znaleziono więcej niż jeden spoiler o podanej nazwie","ERROR_FORUM_CONFIG_CODE_SNIPPET_NONE":"Wskazany spoiler nie zawiera konfiguracji","ERROR_FORUM_CONFIG_CODE_SNIPPET_MULTIPLE":"Wskazany spoiler zawiera więcej niż jedną konfigurację","ERROR_SCREEN_VILLAGE_OUT_OF_GROUP":"Wioska poza grupą. Przechodzę do następnej wioski z grupy","ERROR_SCREEN_REDIRECT":"Przechodzę do przeglądu placu","ERROR_SCREEN_NO_ACTION":"Na tym ekranie nie ma akcji do wykonania","ERROR_CONFIGURATION_MISSING":"Brak konfiguracji użytkownika","ERROR_CONFIGURATION_OPTION_UNKNOWN":"Nieznana opcja: __OPTION_NAME__","ERROR_TROOPS_NOT_ENOUGH":"Nie udało się wybrać wystarczającej liczby jednostek","ERROR_TROOPS_EMPTY":"Obecne ustawienia nie pozwalają na wybór jednostek","ERROR_POOL_EMPTY":"Obecne ustawienia nie definują żadnych celów","ERROR_POOL_EMPTY_SNOBS":"W puli wiosek pozostały wioski, leżące poza zasięgiem szlachciców","ERROR_POOL_EMPTY_BLOCKED_VILLAGES":"W puli wiosek pozostały wioski, które zostały niedawno wybrane","ERROR_POOL_EMPTY_BLOCKED_PLAYERS":"W puli wiosek pozostały wioski, które należą od ostatnio wybranych graczy","ERROR_POOL_EMPTY_NIGHT_BONUS":"W puli wiosek pozostały wioski, na które atak doszedłby w bonusie nocnym","ERROR_POOL_EMPTY_DATE_RANGES":"W puli wiosek pozostały wioski, na które atak doszedłby poza wybranym przedziałami czasowymi"}')},927:n=>{n.exports=JSON.parse('{"HEADER":"WTF - What a Terrible Failure","FORUM_THREAD":"Wątek na forum","DESCRIPTION":"Coś poszło nie tak. Jeżeli jesteś przekonany/a, że konfiguracja jest prawidłowa, wklej poniższe zaklęcie na forum wraz z krótkim opisem czynności, które doprowadziły do tej katastrofy"}')}},t={};function o(e){var i=t[e];if(void 0!==i)return i.exports;var a=t[e]={exports:{}};return n[e](a,a.exports,o),a.exports}(()=>{const n=function(n){if(!window["Hermitowski.Tracing"]||!window["Hermitowski.Tracing"][n])return{log:function(){},t:function(){},o:function(){}};const t=(new Error).stack.split("\n").slice(1),o="color: green;",e=function(){var o=(new Error).stack.split("\n").slice(2);const e=[`%c${n}`];for(var a=1;a<=o.length;a++)if(t.length-a<0||t.length-a>=0&&o[o.length-a]!=t[t.length-a]){const n=i(o[o.length-a]);n.length>0&&e.push(n)}return e.push(""),e},i=function(n){let t=n.split("@")[0];const o=t.split("async*");return o.length>1&&(t=o[1]),t=t.trim(),t},a={};return{log:function(){const n=e();console.log.apply(void 0,[n.join(" | "),o,...arguments])},t:function(){const n=e(),t=i(n[0]);a[t]=Date.now(),console.group.apply(void 0,[n.join(" | "),o,"Entry",...arguments])},o:function(){const n=e(),t=i(n[0]),r=a[t],c=[n.join(" | "),o,`Exit | Elapsed time: ${Date.now()-r} [ms]`];arguments.length>0&&c.push(` Returning: ${arguments[0]}`),console.log.apply(void 0,c),console.groupEnd()}}};async function t(n){"string"!=typeof n&&(n=JSON.stringify(n));const t=(new TextEncoder).encode(n),o=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(o)).map((n=>n.toString(16).padStart(2,"0"))).join("")}function e(n){return n<10?`0${n}`:`${n}`}function i(n){return parseInt((void 0!==n?n.getTime():Date.now())/1e3)}async function a(n){const t=new Promise(((t,o)=>{n.onsuccess=function(n){t(n.target.result)},n.onerror=function(n){o(n)}}));return await t}function r(n,t){return Math.floor(Math.random()*(t-n)+n)}const c="name",s="value",u="expiration_time_s",l=async function(){const o="Hermitowski.Storage",e=n(o),i="storage",r="readwrite",l="readonly",_="relaxed";e.t(arguments),e.log("Opening database");const f=window.indexedDB.open(o,1);f.onupgradeneeded=function(n){const t=n.target.result.createObjectStore(i,{keyPath:c,autoIncrement:!1});t.createIndex(c,c,{unique:!0}),t.createIndex(u,u,{unique:!1})};const p=await a(f),w=function(){return parseInt(Date.now()/1e3)};e.log("Deleting expired items");var d=p.transaction(i,r).objectStore(i).index(u).openCursor(IDBKeyRange.upperBound(w()));d.onsuccess=function(n){var t=n.target.result;t&&(e.log(t),t.delete(),t.continue())};const y=async function(n,o){return n+"."+("string"==typeof o?o:await t(o))};return e.o(),{i:async function(n,t){e.t(arguments);const o=await y(n,t),r=await a(p.transaction(i,l,{durability:_}).objectStore(i).get(o));return e.log(o,r,w()),e.o(),r&&r.u>w()?r:null},l:async function(n,t,o,l){e.t(arguments);const _=await y(n,t),f={[c]:_,[u]:w()+l,[s]:o};e.log(f),await a(p.transaction(i,r).objectStore(i).put(f)),e.o()},_:async function(n,t,o){e.t(arguments);const c=await y(n,t);let s=await a(p.transaction(i,l,{durability:_}).objectStore(i).get(c));return(!s||s.u<w())&&(s=await o(),s.name=c,e.log("created instance",s),await a(p.transaction(i,r,{durability:_}).objectStore(i).put(s))),s.name=t,e.log("returning",s),e.o(),s}}},_=async function(o){const e="Hermitowski.MapFiles",a=n(e),_=await l(o),f=async function(n){a.t(arguments);var t=[];for(const i of n){var o=_._(e,i,(async function(){return await p(i)}));t.push(o)}var i=await Promise.all(t),r={};for(const n of i)r[n.name]=n;return a.o(),r},p=async function(n){switch(n){case"village":return await w(n,(n=>({id:n[0],x:parseInt(n[2]),y:parseInt(n[3]),p:n[4]})));case"player":return await w(n,(n=>({id:n[0],name:n[1],g:n[2]})));case"ally":return await w(n,(n=>({id:n[0],name:n[1],tag:n[2]})));case"building_info":case"unit_info":case"config":return await d(n);default:throw new Error(`Not supported entity name - ${n}`)}},w=async function(n,t){a.t(arguments);const o=await fetch(`map/${n}.txt`),e=new Date(o.headers.get("last-modified")),l=await o.text(),_=l.split("\n"),f=_.filter((n=>n.trim().length>0)).map((n=>n.split(",").map((n=>g(n))))),p=[];for(const n of f)p.push(t(n));let w=i(e)+3600+r(15,120);return w<i()&&(w=i()+3600),a.o(),{[c]:"",[u]:w,[s]:p}},d=async function(n){a.t(arguments);const t=await fetch(`interface.php?func=get_${n}`),o=await t.text(),e=m(o);return a.o(),{[c]:"",[u]:i()+3600,[s]:e}},y=new RegExp(/\+/,"g"),g=function(n){return decodeURIComponent(n.replace(y," "))},m=function(n){const t=(new window.DOMParser).parseFromString(n,"text/xml");return O(t.children[0])},O=function(n){let t={};if(0===n.childElementCount)return n.textContent;for(const o of n.children)t[o.nodeName]=O(o);return t};return{m:async function(n){a.t(arguments);const t=await f(n);for(const o of n)t[o]=t[o].value;return a.o(),t},i:async function(n){const t=await _.i(o,n);return t?t.value:null},l:async function(n,t,e){return await _.l(o,n,t,e)},O:async function(n,e,i){a.t(arguments);const r="string"==typeof i?i:await t(i),l=async function(){a.t(arguments);const t=await f(e),o={};for(const n of e)o[n]=t[n].value;a.log("Passing following arguments into factory method",o,i);const r=await n(o,i);a.log("Computed result",r);const l=Math.min(...Object.keys(t).map((n=>t[n].u)));a.log("Expiration time set to",l);const _={[c]:"",[u]:l,[s]:r};return a.o(),_};var p=await _._(o,r,l);return a.o(),p.value},R:async function(n,e,r){a.t();const l=await t(n.toString()+JSON.stringify(e));a.log("Digest: ",l);var f=await _._(o,l,(async function(){a.t();const t=await n(e),o=i()+r;a.log("Expiration time set to",o);const l={[c]:"",[u]:o,[s]:t};return a.o(),l}));return a.o(),f.value}}},f={safeguard:{},troops_templates:[{spy:1,ram:1},{spy:1,catapult:1},{ram:1},{catapult:1}],fill_exact:!1,fill_troops:"spear,sword,axe,archer,spy,light,marcher,heavy,ram,catapult",changing_village_enabled:!0,coords:"",players:"",allies:"",ally_tags:"",include_barbarians:!1,boundaries:[],forum_config:{thread_id:null,page:0,spoiler_name:null,ttl:300},blocking_enabled:!1,blocking_local:{time_s:5,count:1,block_players:!0,scope:"village"},blocking_global:[],skip_night_bonus:!0,date_ranges:[]},p=o(982),w=0,d=1,y=0,g=1,m=2,O=3,R=4,b=0,E=1,k=0,N=1,h=2,I=3,T=4,S="0",z={k:null,N:null,h:null,units:null,I:{},T:async function(n,t){z.N.t(arguments);for(const t in n)document.querySelector(`#unit_input_${t}`).value=n[t]>0?n[t]:"";const o=document.querySelector(".target-input-field");o?o.value=`${t[y]}|${t[g]}`:(document.querySelector("#inputx").value=t[y],document.querySelector("#inputy").value=t[g]);const i=z.S(n),a=z.P(t,i);z.N.log("Speed: ",i,"Arrival time",a);let r="";t[O]&&(r+=t[O]),t[R]&&(r+=` [${t[R]}]`);const c=p.ATTACK_TIME.replace("__DAY__",e(a.getDate())).replace("__MONTH__",e(a.getMonth()+1)).replace("__HOURS__",e(a.getHours())).replace("__MINUTES__",e(a.getMinutes())).replace("__PLAYER_INFO__",r).replace("__TARGET__",`${t[y]}|${t[g]}`);await z.j(t),UI.SuccessMessage(c),z.N.o()},P:function(n,t){const o=z.M(n);return new Date(1e3*(z.A+o*t*60))},M:function(n){return Math.hypot(game_data.v.x-n[y],game_data.v.y-n[g])},F:async function(n){if(z.N.t(arguments),"object"!=typeof n)throw p.ERROR_CONFIGURATION_MISSING;if(null!=n.forum_config){const t=n.forum_config;if("string"!=typeof t.spoiler_name)throw p.ERROR_FORUM_CONFIG_SPOILER_NAME;if(isNaN(parseInt(t.thread_id)))throw p.ERROR_FORUM_CONFIG_THREAD_ID;t.thread_id=parseInt(t.thread_id),z.N.log(t),n=await z.D(t)}const t=f;for(const o in n)if(!t.hasOwnProperty(o))throw p.ERROR_CONFIGURATION_OPTION_UNKNOWN.replace("__OPTION_NAME__",o);const o={date_ranges:function(n){const t=function(n){const t=n.match(/\d+/g)||[];return 5==t.length||2==t.length?[-1,-1,-1,...t.map(Number)].slice(-5):null},o=[];if(Array.isArray(n)){for(const e of n)if("string"==typeof e){const n=e.split("-");if(2==n.length){const e=[t(n[0]),t(n[1])];e[0]&&e[1]&&o.push(e)}}return o}},boundaries:function(n){const t=[];if(Array.isArray(n))for(const o of n)o.hasOwnProperty("center")&&"string"==typeof o.C&&(o.C=o.C.split("|").map(Number)),t.push(o);return t}};for(const e in t)if(null!=n[e]){const t=o[e];z.I[e]=t?t(n[e]):JSON.parse(JSON.stringify(n[e]))}else z.I[e]=t[e];z.N.log("Configuration",z.I),z.N.o()},D:async function(n){z.N.t(arguments);const t=await z.k.R((async function(n){const t=TribalWars.buildURL("GET","forum",{U:"view_thread",thread_id:n.thread_id,page:n.page||0});z.N.log("Fetching",t);const o=await fetch(t),e=await o.text(),i=document.createElement("document");i.innerHTML=e;const a=[...i.querySelectorAll("div.forum-content")].pop();if(!a)throw p.ERROR_FORUM_CONFIG_THREAD_DOES_NOT_EXIST;const r=a.querySelectorAll(`div.spoiler > input[value="${n.spoiler_name}"]`);if(0==r.length)throw p.ERROR_FORUM_CONFIG_SPOILER_NONE;if(r.length>1)throw p.ERROR_FORUM_CONFIG_SPOILER_MULTIPLE;const c=r[0].parentElement;z.N.log(c);const s=c.querySelectorAll("pre");if(0==s.length)throw p.ERROR_FORUM_CONFIG_CODE_SNIPPET_NONE;if(s.length>1)throw p.ERROR_FORUM_CONFIG_CODE_SNIPPET_MULTIPLE;const u=s[0].innerText,l=JSON.parse(u);return z.N.log("Extracted",u,l),l}),n,n.ttl||3600);return z.N.o(),t},$:function(){if(document.querySelector(".jump_link")&&this.G(p.ERROR_SCREEN_VILLAGE_OUT_OF_GROUP),"place"!==game_data.screen||1!==$("#command-data-form").length)throw location=TribalWars.buildURL("GET","place",{mode:"command"}),p.ERROR_SCREEN_REDIRECT;if(document.querySelector("#troop_confirm_go")||document.querySelector("#troop_confirm_submit"))throw p.ERROR_SCREEN_NO_ACTION},G:function(n){if(z.I.changing_village_enabled){const n=document.querySelector("#village_switch_right"),t=document.querySelector(".jump_link");n?location=n.href:t&&(location=t.href)}throw n},L:function(){if(z.N.t(arguments),z.H(),z.I.troops_templates.length>0){for(const n of z.I.troops_templates){const t=JSON.parse(JSON.stringify(n));if(z.W(t))return z.N.log("Selecting",t),z.N.o(),t}z.G(p.ERROR_TROOPS_NOT_ENOUGH)}z.G(p.ERROR_TROOPS_EMPTY),z.N.o()},W:function(n){z.N.t(arguments);const t=z.Y();z.N.log("Available troops",t),z.N.log("Inspecting",n);for(const o in n)if(t[o]<n[o])return z.N.log("Skipping template. Required ",o,":",n[o]," got only",t[o]),!1;const o=Number(z.h.K.B.J);if(0==o)return z.N.log("There is no fake limit"),z.N.o(),n;if(5==n.spy&&Object.keys(n).filter((n=>"spy"!==n)).every((t=>0==n[t])))return z.N.log("Special case. Only 5 spies"),z.N.o(),n;const e=Math.floor(game_data.v.points*o*.01);z.N.log("Population required",e);const i=z.q(n);z.N.log("Template population",i);for(const t of z.units)n.hasOwnProperty(t)||(n[t]=0);const a=z.I.fill_troops.split(",");let r=e-i;z.N.log("fill_troops",a);for(const o of a){const e=o.split(":"),i=e[0],a=[];if(t[i]-n[i]>0&&a.push(t[i]-n[i]),e.length>1&&a.push(Number(e[1])),a.length>0){(!z.I.fill_exact||z.I.fill_exact>r>0)&&a.push(Math.ceil(r/z.h.V[i].pop));const t=Math.min(...a);n[i]+=t,r-=z.h.V[i].pop*t,z.N.log("Population left",r,"fill_entry",o,"unit",i,"unit_count",t)}}return z.N.o(),r<=0},X:async function(n){z.N.t(arguments);const t=z.S(n);z.N.log("Troops speed",t);let o=await z.Z();z.N.log("Initial pool",o),o=await z.nn(o,n),z.N.log("After applying troops constraints",o),o=await z.tn(o),z.N.log("After blocking",o),o=await z.on(o,n),z.N.log("After applying date ranges ",o);const e=o[Math.floor(Math.random()*o.length)];return z.N.log("Returning",e),z.N.o(),e},Z:async function(){z.N.t(arguments);const n={allies:z.I.allies,ally_tags:z.I.ally_tags,players:z.I.players,include_barbarians:z.I.include_barbarians,boundaries:z.I.boundaries,coords:z.I.coords},t=await z.k.O((async function(n,t){z.N.t();const o=t.players.split(",").map((n=>n.trim().toLowerCase())),e=t.allies.split(",").map((n=>n.trim().toLowerCase())),i=t.ally_tags.split(",").map((n=>n.trim().toLowerCase()));z.N.log("Players",o,"Allies",e,"Ally tags",i);const a=new Set(n.en.filter((n=>e.includes(n.name.toLowerCase())||i.includes(n.tag.toLowerCase()))).map((n=>n.id))),r=new Set(n.an.filter((n=>o.includes(n.name.toLowerCase())||a.has(n.g))).map((n=>n.id)));z.N.log("Player ids",r);const c=new Set,s=[];let u=n.v.filter((n=>t.include_barbarians&&n.p===S||r.has(n.p)));z.N.log("Villages before applying boundaries",u),t.boundaries.length&&(u=u.filter((n=>z.rn(n,t.boundaries)))),z.N.log("Villages after applying boundaries",u);for(const t of u){const o=t.p!==S?n.an.find((n=>n.id==t.p)):null,e=null!=o&&"0"!==o.g?n.en.find((n=>n.id==o.g)):null,i=o?o.name:null,a=e?e.tag:null;s.push([t.x,t.y,t.p,i,a]),c.add(1e3*t.x+t.y)}const l=new RegExp(/\d{1,3}\|\d{1,3}/g),_=t.coords.match(l);if(null!=_)for(const t of _.map((n=>n.split("|").map(Number)))){const o=1e3*t[0]+t[1];if(!c.has(o)){const e=n.v.find((n=>n.x==t[0]&&n.y==t[1]));e&&(s.push([e.x,e.y,e.p]),c.add(o))}}return z.N.o(),s}),["ally","player","village"],n);if(0===t.length)throw p.ERROR_POOL_EMPTY;return z.N.o(t),t},rn:function(n,t){for(const o of t)if(o.hasOwnProperty("center")){const t=o.C[0]-n.x,e=o.C[1]-n.y;if(t*t+e*e<=o.r*o.r)return z.N.log("Accepting village",n," in circle"),!0}else if(o.hasOwnProperty("min_x")&&o.cn<=n.x&&n.x<=o.sn&&o.un<=n.y&&n.y<=o.ln)return z.N.log("Accepting village",n," in box"),!0;return!1},on:async function(n,t){z.N.t(arguments);const o=z.S(t),e=Object.keys(t).filter((n=>"spy"!==n)).every((n=>0==t[n]));if("1"===z.h.K._n.active&&z.I.skip_night_bonus&&!e){const t=Number(z.h.K._n.fn),e=Number(z.h.K._n.pn);if(0===(n=n.filter((n=>{if(n[m]===S)return!0;const i=z.P(n,o);return t>e?i.getHours()<t&&i.getHours()>e-1:t<=i.getHours()&&i<=e-1}))).length)throw p.ERROR_POOL_EMPTY_NIGHT_BONUS}const i=function(n){return 60*n[I]+n[T]};if(z.N.log("Faking.settings.date_ranges",z.I.date_ranges),z.I.date_ranges.length>0){const t=n;for(const e of z.I.date_ranges){z.N.log("date_range",e);let a=null;if(-1!=e[b][k]&&-1!=e[E][k]){const n=new Date(e[b][h],e[b][N]-1,e[b][k],e[b][I],e[b][T]),t=new Date(e[E][h],e[E][N]-1,e[E][k],e[E][I],e[E][T]);z.N.log("lower_bound",n,"upper_bound",t),a=function(e){const i=z.P(e,o);return z.N.log(e,n<=i&&i<=t,i),n<=i&&i<=t}}else{const n=i(e[b]),t=i(e[E]);z.N.log("Minutes from",n,t),a=function(e){const a=z.P(e,o),r=i([-1,-1,-1,a.getHours(),a.getMinutes()]);return z.N.log(e,r,n<=r&&r<=t,a),n<=r&&r<=t}}if((n=t.filter(a)).length>0)break}if(0==n.length)throw p.ERROR_POOL_EMPTY_DATE_RANGES}return z.N.o(n),n},nn:function(n,t){return z.N.t(arguments),t.wn>0&&(z.N.log(n.map((n=>z.M(n)))),0===(n=n.filter((n=>z.M(n)<Number(z.h.K.wn.dn)))).length&&z.G(p.ERROR_POOL_EMPTY_SNOBS)),z.N.o(n),n},tn:async function(n){return z.N.t(arguments),z.I.blocking_enabled&&(n=await z.yn(n),n=await z.gn(n)),z.N.o(n),n},yn:async function(n){return z.N.t(arguments),n=await z.mn(n,z.On(),z.I.blocking_local.count,z.I.blocking_local.block_players),z.N.o(n),n},gn:async function(n){z.N.t(arguments);for(const t of z.I.blocking_global)n=await z.mn(n,z.Rn(t.name),t.count,t.block_players);return z.N.o(n),n},On:function(){return"village"===z.I.blocking_local.scope?`blocking.l.${game_data.v.id}`:{bn:game_data.v.id,I:z.I}},Rn:function(n){return`blocking.g.${n}`},mn:async function(n,t,o,e){z.N.t(arguments);const i=await z.En(t),a=new Map,r=new Set,c=function(n){return 1e3*n[y]+n[g]};for(const n of i){const t=c(n[d]);if(a.has(t)?a.set(t,a.get(t)+1):a.set(t,1),e){const t=n[d][m];t!=S&&r.add(t)}}if(z.N.log(a,r),z.N.log("Block table",i),0===(n=n.filter((n=>{const t=c(n);return(a.get(t)||0)<o}))).length)throw p.ERROR_POOL_EMPTY_BLOCKED_VILLAGES;if(e&&0===(n=n.filter((n=>{const t=n[m];return!r.has(t)}))).length)throw p.ERROR_POOL_EMPTY_BLOCKED_PLAYERS;return z.N.log("After applying block table",t,n),z.N.o(n),n},j:async function(n){if(z.I.blocking_enabled){await z.kn(n,z.On(),z.I.blocking_local.time_s);for(const t of z.I.blocking_global)await z.kn(n,z.Rn(t.name),t.time_s)}},En:async function(n){z.N.t(arguments);let t=await z.k.i(n)||[];const o=parseInt(Date.now()/1e3);for(let e=0;e<t.length;e++)if(t[e][w]>o){e>0&&(z.N.log("Trimming",n,"block table by",e,"entries"),t=t.slice(e));break}return z.N.o(t),t},kn:async function(n,t,o){z.N.t(arguments);const e=await z.En(t),i=parseInt(Date.now()/1e3)+o,a=[i,n];z.N.log("Adding block entry",a),e.push(a),await z.k.l(t,e,o),z.N.o()},S:function(n){let t=0;for(const o in n)n.hasOwnProperty(o)&&0!==n[o]&&(t=Math.max(Number(z.h.V[o].speed),t));if(0===t)throw p.ERROR_TROOPS_EMPTY;return t},q:function(n){return Object.keys(n).map((t=>n[t]*Number(z.h.V[t].pop))).reduce(((n,t)=>n+t),0)},H:function(){for(const n of[...document.querySelectorAll("[id^=unit_input_]"),document.querySelector(".target-input-field"),document.querySelector("#inputx"),document.querySelector("#inputy")])n&&(n.value="")},Y:function(){const n={};for(let t of z.units)n[t]=Number(document.querySelector(`#unit_input_${t}`).dataset.allCount),z.I.safeguard.hasOwnProperty(t)&&(n[t]=Math.max(0,n[t]-z.I.safeguard[t]));return n},init:async function(){z.N.t(arguments);const n=["config","unit_info"];z.h=await z.k.m(n),z.units=game_data.units.filter((n=>"militia"!==n)),z.A=i(),z.N.o()},Nn:async function(t,o){z.N=n(t),z.k=await _(t),z.N.t(arguments),z.$(),await z.F(o),await z.init();const e=z.L(),i=await z.X(e);await z.T(e,i),z.N.o()}},P=o(927);const j=async function(n,t){try{await t()}catch(t){!function(n,t){if("string"==typeof n)return void UI.ErrorMessage(n);const o=`<h2>${P.HEADER}</h2>\n        <p>\n            ${P.DESCRIPTION}\n            <textarea rows='12' cols='80'>${n}\n\n${n.stack}</textarea><br/>\n            <a href='${t}'>${P.FORUM_THREAD}</a>\n        </p>`;Dialog.show("Hermitowski.Bootstrap",o)}(t,n)}};!async function(){await j("https://forum.plemiona.pl/index.php?threads/hermitowskie-fejki.125294/",(async function(){await z.Nn("Hermitowski.Faking","object"==typeof HermitowskieFejki?HermitowskieFejki:void 0)}))}()})()})();